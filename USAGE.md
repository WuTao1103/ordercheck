# 使用指南 - 前端核对自动保存到数据库

## 🎯 功能说明

您的Order Check应用现在已经完全集成了数据库功能。每次在前端进行订单核对时，系统会自动将核对结果保存到MySQL数据库中。

## 🚀 使用步骤

### 1. 启动服务

```bash
# 启动后端API服务
cd backend
npm start

# 启动前端服务（新终端）
npm start
```

### 2. 访问应用

打开浏览器访问：`http://localhost:3000`

### 3. 进行订单核对

1. **上传Excel文件**
   - 点击"选择文件"按钮
   - 选择包含"寄修单号"和"跟踪号"列的Excel文件
   - 系统会自动解析并显示订单列表

2. **输入核对信息**
   - 在"输入工单号"框中输入工单号
   - 按Enter键切换到跟踪号输入框
   - 在"输入运输单号"框中输入跟踪号
   - 按Enter键进行核对

3. **查看核对结果**
   - 核对成功：播放成功音效，对应订单标记为已完成
   - 核对失败：播放错误音效
   - **重要**：无论成功还是失败，都会自动保存到数据库

### 4. 查看历史记录

1. **切换到记录查询界面**
   - 点击"查看记录"按钮
   - 界面会切换到记录查询功能

2. **查询历史记录**
   - 输入工单号进行筛选
   - 输入跟踪号进行筛选
   - 选择开始日期和结束日期
   - 点击"查询"按钮

3. **查看统计信息**
   - 系统会显示总核对次数
   - 显示成功次数和失败次数
   - 显示成功率百分比

## 📊 数据库记录结构

每次核对都会在数据库中创建一条记录：

```sql
CREATE TABLE check_records (
  id INT AUTO_INCREMENT PRIMARY KEY,
  work_order VARCHAR(100) NOT NULL,      -- 工单号
  tracking_number VARCHAR(100) NOT NULL,  -- 跟踪号
  check_result BOOLEAN NOT NULL,          -- 核对结果（1=成功，0=失败）
  check_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP  -- 核对时间
);
```

## 🔍 验证数据保存

### 方法1：通过前端界面
1. 进行几次核对操作
2. 点击"查看记录"
3. 查看是否有新的记录出现

### 方法2：通过数据库查询
```sql
mysql -h192.168.0.50 -uroot -p123456 ordercheck_db
SELECT * FROM check_records ORDER BY check_time DESC LIMIT 10;
```

### 方法3：通过API测试
```bash
# 保存记录
curl -X POST http://localhost:3001/api/check-records \
  -H "Content-Type: application/json" \
  -d '{"workOrder":"TEST001","trackingNumber":"123456789012","checkResult":true}'

# 查询记录
curl "http://localhost:3001/api/check-records?page=1&limit=5"

# 获取统计
curl "http://localhost:3001/api/check-records/stats"
```

## ⚡ 自动化流程

1. **前端核对** → 自动保存到数据库
2. **数据库存储** → 持久化保存
3. **查询接口** → 实时获取历史记录
4. **统计接口** → 实时计算成功率

## 🎵 音效反馈

- **成功音效**：核对成功时播放
- **错误音效**：核对失败时播放
- 音效播放不影响数据保存

## 📈 统计功能

- **总核对次数**：所有核对操作的总数
- **成功次数**：核对成功的次数
- **失败次数**：核对失败的次数
- **成功率**：成功次数/总次数的百分比

## 🔧 故障排除

### 问题1：核对后没有保存到数据库
- 检查后端服务是否正常运行（端口3001）
- 检查数据库连接是否正常
- 查看浏览器控制台是否有错误信息

### 问题2：无法查询历史记录
- 确认后端API服务正常运行
- 检查网络连接
- 查看后端服务日志

### 问题3：统计信息不准确
- 刷新页面重新加载
- 检查数据库中的数据完整性
- 重新启动后端服务

## ✅ 测试清单

- [ ] 前端核对功能正常
- [ ] 成功/失败音效正常播放
- [ ] 数据自动保存到数据库
- [ ] 历史记录查询功能正常
- [ ] 统计信息显示正确
- [ ] 界面切换功能正常

现在您的应用已经完全集成了数据库功能，每次核对操作都会自动保存，方便后续查询和统计！ 